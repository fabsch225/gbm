\documentclass{beamer}

\usepackage{wrapfig}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{graphicx}
\pgfplotsset{compat=1.18}
\usepackage{amsmath}
\usetikzlibrary{intersections, through, calc}

\renewcommand{\algorithmcfname}{Algorithmus}

% Theme and colors
\usetheme{Singapore} % Clean layout
\usecolortheme{default}

% Custom colors
\definecolor{DarkBlue}{RGB}{10, 25, 47} % Dark navy
\definecolor{FrameTextColor}{RGB}{255,255,255}

% Set background canvas color (header/footer)
\setbeamercolor{frametitle}{bg=DarkBlue, fg=FrameTextColor}
\setbeamercolor{title}{bg=DarkBlue, fg=FrameTextColor}
\setbeamercolor{author}{fg=FrameTextColor}
\setbeamercolor{date}{fg=FrameTextColor}
\setbeamercolor{section in head/foot}{bg=DarkBlue, fg=FrameTextColor}
\setbeamercolor{subsection in head/foot}{bg=DarkBlue, fg=FrameTextColor}
\setbeamercolor{footline}{bg=DarkBlue, fg=FrameTextColor}
\setbeamercolor{headline}{bg=DarkBlue, fg=FrameTextColor}

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}

% Title page setup
\title[Kolloquium]{Kolloquium}
\subtitle[Die geometrische Brownsche Bewegung und Anwendungen]{Die geometrische Brownsche Bewegung und Anwendungen}
\author{Fabian Schuller}
\date{\today}

% Custom footline (optional)
\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=0.7\paperwidth,ht=2.5ex,dp=1ex,left]{author in head/foot}%
    \hspace{1em}\insertshortauthor{} - \insertshorttitle{}
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=0.3\paperwidth,ht=2.5ex,dp=1ex,right]{date in head/foot}%
    \insertframenumber{} / \inserttotalframenumber\hspace{1em}
  \end{beamercolorbox}}%
  \vskip0pt%
}

% Begin document
\begin{document}

\section{Einleitung}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Ablauf}
  \begin{itemize}
    \item Presentation der Inhalte der Bachelorarbeit
    \begin{itemize}
      \item Grundlagen zu Stochastischen Prozessen und der Brownschen Bewegung
      \item Herleitung der geometrischen Brownschen Bewegung aus dem Binomialmodell
      \item Modellierung von Finanzzeitreihen mit der geometrischen Brownschen Bewegung
      \item Bewertung von Aktienoptionen mit Black Scholes
      \item Weiterführende Themen: Stochastische Differentialgleichungen und das CEV-Modell
    \end{itemize}
    \item Diskussion
  \end{itemize}
\end{frame}

\section{Die Brownsche Bewegung}

\begin{frame}{Stochastische Prozesse}
    \begin{itemize}
      \item Folgen bzw. Familien von Zufallsvariablen $$X_t,\quad t \in \Bbb N \quad \mathrm{ bzw. } \quad  t \in \Bbb R_{\ge 0}$$
      \item Zeitdiskrete Prozesse: Wiederholter Münzwurf, Zufallsspaziergang
      \item Zeitstetige Prozesse: Brownsche Bewegung
    \end{itemize}
    \begin{figure}
      \centering
      \includegraphics[width=1\textwidth]{images/bb_2d.png}
    \end{figure}
\end{frame}

\begin{frame}{Die diskrete Brownsche Bewegung}
  \begin{itemize}
    \item Konstruktion durch aufsummierte unabhängige Normalvariablen
    \item Skaliertes Interpolationsverfahren (N-ter Ordnung) ($\rightarrow$ Varianz $\to$ t)
    \item Martingal-Eigenschaft und Varianzwachstum linear in der Zeit
  \end{itemize}
  \begin{figure}
    \centering
  \includegraphics[width=0.4\textwidth]{../thesis/images/disrete_bb.png}
  \end{figure}
\end{frame}

\begin{frame}{Die Brownsche Bewegung}
  \begin{itemize}
  \item Klassische Axiome
    \begin{enumerate}
      \item $W_0=0$ (fast-sicher)
      \item Die Pfade $t \mapsto W_t$ sind (fast-sicher) stetig
      \item Für Zeitpunkte $0 \le t_0 < t_1 \dots$ sind die Zuwächse $W_{t_1} - W_{t_0}$ unabhängig
      \item Die Zuwächse sind normalverteilt mit $W_{t_1} - W_{t_0} \sim N(0, t_1 - t_0)$
    \end{enumerate}
  \pause
  \item Brownsche Bewegung als Grenzwert
    \begin{itemize}
      \item Diskrete Brownsche Bewegung und dann $N \to \infty$
      \item Um die Axiome Nachzuweisen und Verteilungskonvergenz im Funktionenraum: Satz von Donsker
      \item In der Arbeit: Existenz der endlich-dimensionalen Verteilungen (mit Cramér-Wold) und Nachweis der Stetigkeit
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Kovarianzstruktur der Brownschen Bewegung}
  \begin{itemize}
    \item Kovarianz: $\mathrm{Cov}(W_s,W_t)=\min(s,t)$
    \item Bedingte Verteilung: $W_t \mid W_s \sim \mathcal N(W_s,\, t-s)$
  \end{itemize}
  \begin{figure}
    \centering
  \includegraphics[width=0.48\textwidth]{../thesis/images/bb_with_cov.png}
  \end{figure}
\end{frame}

\begin{frame}{Eigenschaften der Brownschen Bewegung}
  \begin{itemize}
      \item Martingal-Eigenschaft
      \item Stationäre, unabhängige Inkremente, normalverteilt
      \item Pfade sind stetig aber nicht differenzierbar (fast-sicher)
      \item Somit eignet sich die Brownsche Bewegung zur Modellierung von Rauschen (Zufälliges Element in einem Prozess)
  \end{itemize}
\end{frame}

\section{Die geometrische Brownsche Bewegung}

\begin{frame}{Die geometrische Brownsche Bewegung}
  \begin{itemize}
      \item Multiplikatives Modell: $S_{k+1}=S_k(1+X_{k+1})$
      \item Annahme: $X_{k+1}=\mu\Delta t+\sigma\sqrt{\Delta t}\,\varepsilon_{k+1}$
      \item $\varepsilon_k$ i.i.d mit $E(\varepsilon_k)=1$, $V(\varepsilon_k)=0$. (Z. B. $\mathcal N(0,1)$-Verteilt)
      \item Dies kann man als diskrete stochastische Differenzengleichung (SDE) interpretieren.
      \item Genauer: Euler-Maruyama-Approximation der SDE $$dS_t = \mu S_t\,dt + \sigma S_t\,dW_t$$
  \end{itemize}
\end{frame}

\begin{frame}{Geschlossene Formel}
  \begin{itemize}
      \item Geschlossene Lösung der SDE / Grenzwert der diskreten Übergangsvariablen
      \begin{itemize}
        \item Limes: $\Delta t \to 0$ (Zeit-Schritt) und $n \to \infty$ (Anzahl der Messungen)
      \end{itemize}
      \item $S_T = S_0 \exp\big((\mu-\tfrac12\sigma^2)T + \sigma W_T\big)$
      \item $S_T$ ist log-normalverteilt
  \end{itemize}
\end{frame}

\begin{frame}{Beweisskizze}
  \begin{itemize}
      \item Ausgangspunkt: $S_{k+1}=S_k(1+X_{k+1})$ mit $X_{k+1}=\mu\Delta t+\sigma\sqrt{\Delta t}\,\varepsilon_{k+1}$
      \item Logarithmierung: $\log S_n = \log S_0 + \sum \log(1+X_j)$
      \item Taylor-Entwicklung bis 2. Ordnung, danach $$
\begin{aligned}
\log S_n &\approx \log S_0 + \sum_{j=1}^n\left( \underbrace{\mu \Delta t + \sigma\sqrt{\Delta t} \varepsilon_j}_{X_j} - \underbrace{\frac{1}{2} \sigma^2 \Delta t \varepsilon_j}_{-\frac{1}{2} X_j^2} \right)
\\ &= \log S_0 + \mu T +  \underbrace{\sigma\sqrt{\Delta t} \sum_{j=1}^{n} \varepsilon_j}_{\mathrm{[ZGWS]} \quad \to \sigma W_T} - \underbrace{\frac{1}{2} \sigma^2 \sum_{j=1}^{n} \Delta t \varepsilon_j^2}_{\mathrm{[GGZ]} \quad \to \frac12 \sigma^2 T}
\end{aligned}
$$
      \item Letztlich $\log S_T \overset{d} = \log S_0 + \big(\mu - \tfrac12 \sigma^2\big)T + \sigma W_T$ \qed
  \end{itemize}
\end{frame}

\begin{frame}{Fazit und Eigenschaften}
  \begin{itemize}
      \item Positivität: $S_t>0$ fast sicher
      \item fast sicher stetige Pfade
      \item Log-Normalverteilt mit $\log S_t \sim N(\log S_0 + \mu - \tfrac12 \sigma^2, \sigma^2)$
  \end{itemize}
\end{frame}

\section{Anwendungen}

\begin{frame}{Kalibrierung}
  \begin{itemize}
      \item Schätzung von $\mu,\sigma$ über Log-Returns
      \begin{itemize}
        \item Daten sind zu einem festen $\Delta t$ gegeben
        \item Aus $\log S_{t + \Delta t} \vert \log S_t \sim N(\mu - \tfrac12 \sigma^2, \sqrt{\Delta t} \sigma^2)$ folgt der Schätzer
        \item $\sigma^2 = s(\Delta \log S_t)$ und $\mu = m(\Delta \log S_t)$ wobei $s$ die empirische Varianz und $m$ das Mittel ist
      \end{itemize}
      \pause
      \item Konfidenzintervalle und Unsicherheitsschätzung (Bootstrap)
      \begin{itemize}
        \item Die Daten sind ggf. unrein
        \item Schätze $\mu$ und $\sigma$ wiederholt sud einer Teilmenge der Daten schätzt
        \item Ein Konfidenzband ergibt probabilistische Schätzung von $\mu$ und $\sigma$
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Simulation}
  \begin{itemize}
      \item Exakte Pfadsimulation für GBM mit der geschlossenen Formel und der diskreten Brownsche Bewegung
      \item Anwendung z. B. Monte-Carlo-Simulation für Optionspreise
      \item Numerik: Euler--Maruyama für verallgemeinerte Modelle (CEV etc.)
  \end{itemize}
  \begin{figure}
    \centering
  \includegraphics[width=0.48\textwidth]{../thesis/images/dax_monte_carlo.png}
  \end{figure}
\end{frame}

\begin{frame}{Backtests}
  \begin{itemize}
      \item Validierung eines Modells anhand historischer Daten
      \item Metriken zur Bewertung
  
  \end{itemize}
\begin{table}[H]
\centering
\begin{tabular}{lcccccc}
Hitratio & MSE \\

\% im Konfidenzintervall & $\frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2$  \\
\hline
NRMSE & MAPE \\
$\frac{\sqrt{\text{MSE}}}{y_{max} - y_{min}}$ & $\frac{100\%}{n} \sum_{i=1}^n \left|\frac{y_i - \hat{y}_i}{y_i}\right|$ \\

\end{tabular}
\end{table}

\end{frame}

\begin{frame}{Visualisierung von Backtests}
  \begin{figure}
    \centering
  \includegraphics[width=0.49\textwidth]{../thesis/images/dax_backtest.png}
  \includegraphics[width=0.49\textwidth]{../thesis/images/dax_backtest_seq.png}
  \end{figure}
\end{frame}

\section{Black-Scholes}

\begin{frame}{Optionen}
  \begin{itemize}
      \item Eine europäische Call Option gibt dem Käufer das Recht, aber nicht die Pflicht, eine Aktie am Zeitpunkt $T$ zum Ausübungspreis $K$ zu kaufen.
      \item Put Option: Recht auf Verkauf (an den Anbieter der Option)
      \begin{itemize}
        \item Beispiel: Absicherung von Getreide-Ernte
      \end{itemize} 
      \item Auszahlungsfunktion $\max(S_T-K,0)$ (Call), $\max(K-S_T, 0)$ (Put)
      \item Amerikanische Optionen: jederzeit Einlösbar
      \item Es gibt viele weitere Optionstypen mit anderen Auszahlungen
  \end{itemize}
\end{frame}

\begin{frame}{Bewertung von Optionen}
  \begin{itemize}
      \item Naiver Ansatz: Erwartungswert der Ausübungsfunktion unter einem Aktienkursmodell wie der GBM
      \pause
      \item Was ist mehr Wert? 100€ jetzt oder 100€ in einem Jahr?
      \pause
      \item 100€ jetzt, denn man könnte das Geld anlegen, und 2\% Zinsen erhalten
      \item Modellerweiterung: Bank bietet risikofreien Zinssatz $r$
      \pause
      \item Arbitrage-Prinzip: Der Trend der Aktie muss beim Preis der Option beachtet werden 
  \end{itemize}
\end{frame}

\begin{frame}{Herleitung des Black-Scholes Modells}
  \begin{enumerate}
      \item Diskretes Modell: Binomialmodell
      \item Options-Bewertung Binomialmodell
      \item Black-Scholes als Limes $N \to \infty$
  \end{enumerate}
\end{frame}

\begin{frame}{Diskretes Modell: Binomialmodell}
      $$S_{t+1} = \begin{cases} 
    d \cdot S_t, & \text{mit Wahrscheinlichkeit }  p \\ 
    u \cdot S_t, & \text{mit Wahrscheinlichkeit }  1-p
\end{cases}$$
     
\begin{center}
\begin{tikzpicture}[x=2.6cm,y=1cm,>=stealth]
    % styles
    \tikzset{price/.style={circle,draw,minimum size=6mm,inner sep=0pt,font=\small}}

    % nodes
    \node[price] (S0)  at (0,0)   {$S_0$};
    \node[price] (Su)  at (1,1)   {$u S_0$};
    \node[price] (Sd)  at (1,-1)  {$d S_0$};
    \node[price] (Suu) at (2,2)   {$u^2 S_0$};
    \node[price] (Sud) at (2,0)   {$u d S_0$};
    \node[price] (Sdd) at (2,-2)  {$d^2 S_0$};

    % edges with probabilities p and 1-p
    \draw[->] (S0) -- node[sloped,above] {$p$} (Su);
    \draw[->] (S0) -- node[sloped,below] {$1-p$} (Sd);

    \draw[->] (Su) -- node[sloped,above] {$p$} (Suu);
    \draw[->] (Su) -- node[sloped,below] {$1-p$} (Sud);

    \draw[->] (Sd) -- node[sloped,above] {$p$} (Sud);
    \draw[->] (Sd) -- node[sloped,below] {$1-p$} (Sdd);

    % time axis labels
    \node[font=\scriptsize] at (0,-2.6) {Zeit 0};
    \node[font=\scriptsize] at (1,-2.6) {Zeit 1};
    \node[font=\scriptsize] at (2,-2.6) {Zeit 2};

    % parameter box
    \node[anchor=west, align=left, font=\scriptsize] at (2.6,2.0) {Parameter:\\
        Aufstieg $u>1$\\
        Abstieg $0<d<1$\\
        Wkt. $p\in(0,1)$
    };
\end{tikzpicture}
\end{center}

\end{frame}

\begin{frame}{Bewertung von Optionen}
  \begin{itemize}
      \item Unter Beachtung des risikofreien Zinssatzes wird der Kurs diskontiert: $\tilde S_t = e^{-r t} S_t$ 
      \pause
      \item Arbitrage-Prinzip: Der Preis der Option muss unabhängig vom Trend der Aktie sein
      \item Mathematisch Formuliert: Martingal-Eigenschaft: für $s < t$ gilt $$E(e^{-rt}S_t | S_s = v) = e^{-rs} v$$
      \pause
      \item Man konstruirt das risikoneutrale Maß $Q$, um die Martingaleigenschaft des diskontierten Kurses zu garantieren, und nutzt dieses zur Bewertung der Option
  \end{itemize}
\end{frame}

\begin{frame}{Beispiel: risikoneutrale ein-Schritt-Wahrscheinlichkeit}
Frage: wie muss $p$ aussehen, damit $e^{-r t} S_t$ im Binomialmodell ein Martingal ist? Diese Wahrscheinlichkeit wird im folgenden $q$ genannt.

$$
\begin{aligned}
&E(e^{-r (n+1) \Delta t} S_{n+1} \mid S_n = v) = e^{-r n \Delta t} v
\\ 
\iff &E(e^{-r \Delta t} S_{n+1} \mid S_n=v) = v.
\end{aligned}
$$
Setzt man die möglichen Werte für $S_{n+1}$ ein ($S_{n+1} = u S_n$ mit Wahrscheinlichkeit $q$, $S_{n+1} = d S_n$ mit Wahrscheinlichkeit $1-q$) folgt
$$
\begin{aligned}
&e^{-r \Delta t} \left( q u S_n + (1-q) d S_n \right) = v.
\\
&e^{-r \Delta t} \left( q u + (1-q) d \right) = 1
\\
&q = \frac{e^{r \Delta t} - d}{u - d}
\end{aligned}
$$ \qed
\end{frame}

\begin{frame}{Bewertung von Optionen im Binomialmodell}
  \begin{itemize}
      \item Zum Zeitpunkt $N$ der Auszahlung ist der Wert der Option genau die Auszahlungsfunktion, z. B. $\max(S_T - K, 0)$
      \item Zum Zeitpunkt $N-1$ und davor durch Rückwärtsinduktion gilt mit der risikoneutralen Wahrscheinlichkeit $q$
      $$
      \begin{aligned}
C_{n-1} &= E_Q(e^{-r \Delta t} C_{n} \mid S_{n-1}) \\
&= e^{-r \Delta t} \left( q C_{n}^\text{up} + (1-q) C_{n}^\text{down} \right)
      \end{aligned}
      $$
  \end{itemize}
\end{frame}

\begin{frame}{Das Black-Scholes Modell}
  \begin{itemize}
      \item Modellannahmen: GBM, konstante $r,\sigma$, keine Transaktionskosten
      \item Die diskrete Zeit im Binomialmodell wird stetig durch den Limes $N \to \infty$
      \item In der Arbeit wird gezeigt, dass $S_t$ unter $Q$ wieder eine GBM ist. Damit kann man Aktien direkt durch Simulation bewerten (Monte-Carlo-Verfahren)
      \item Für europäische Optionen gilt darüber hinaus die explizite Formel
      $$C_0^{\mathrm{BS}}= S_0\,\Phi(d_1) - K e^{-rT}\,\Phi(d_2)$$ mit
      $$
d_1 = \frac{\ln(S_0/K) + \big(r + \tfrac12 \sigma^2\big)T}{\sigma \sqrt{T}},
\qquad
d_2 = d_1 - \sigma \sqrt{T}.
$$
  \end{itemize}
\end{frame}

\begin{frame}{Beispiele}
  \begin{itemize}
      \item Numerische Bewertung vs. geschlossene Formel: Vergleich für DAX-Calls
      \item Monte-Carlo- vs. Black-Scholes-Ergebnisvergleiche
  \end{itemize}
  \begin{figure}
    \centering
  \includegraphics[width=0.88\textwidth]{../thesis/images/call_dax_mc.png}
  \end{figure}
\end{frame}

\section{Ausblick}

\begin{frame}{CEV-Modell}
  \begin{itemize}
    \item Alternative zur GBM
    \item Stochastische Differentialgleichung: $$dS_t \;=\; \mu S_t\,dt \;+\; \sigma\,S_t^{\beta}\,dW_t$$
    \item Diskretisierung: $$\Delta S_i := S_{t_{i+1}} - S_{t_i} \approx \mu S_{t_i}\Delta t + \sigma S_{t_i}^{\beta}\sqrt{\Delta t}\,\varepsilon_i,\quad \varepsilon_i\sim\mathcal N(0,1)$$
    \item Übergangswahrscheinlichkeit: $$\Delta S_i \mid S_{t_i} \sim \mathcal N\left(\mu S_{t_i} \Delta t,\, \sigma^2 S_{t_i}^{2\beta} \Delta t\right)$$
  \end{itemize}
\end{frame}

\begin{frame}{Kalibrierung des CEV-Modell}
  \begin{itemize}
    \item Übergangswahrscheinlichkeit: $$\Delta S_i \mid S_{t_i} \sim \mathcal N\left(\mu S_{t_i} \Delta t,\, \sigma^2 S_{t_i}^{2\beta} \Delta t\right)$$
    \item Dichte: $$p(x) = \frac{1}{\sqrt{2\pi v}} \exp\left(-\frac{(x-m)^2}{2v}\right),\quad m = \mu S_{t_i}, v = \sigma^2 S_{t_i}^{2 \beta}$$
    \item ML-Schätzer: Betrachte alle Realisierungen der Zeitreihe, und maximiere die Dichte in Abhängigkeit der Parameter
  $$L(\mu, \sigma, \beta) = \prod_{i=0}^{n-1} p(\Delta S_i \mid S_{t_i})$$
    \item Dies wurde in der Arbeit implementiert und mit der GBM verglichen
  \end{itemize}
\end{frame}

\begin{frame}{Schlusswort}
  \centering
  \Huge Vielen Dank für Ihre Aufmerksamkeit\\
\end{frame}

\end{document}